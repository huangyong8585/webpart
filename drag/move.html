<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>一个Div拖动</title>
<style>
*{padding:0;margin:0;}
body{position:relative;height:100%; background-color:#f0f0f0;}
#test{position:absolute;left:100px;top:100px;height:100px;width:100px;background-color:#FFF;cursor:move;/*-moz-user-select:-moz-none;*/}
</style>
</head>

<body>
<div id="test" onselectstart="javascript:return false;"></div>
<!--<img src="http://a.hiphotos.baidu.com/ting/pic/item/fd039245d688d43fd123dd767d1ed21b0ff43baf.jpg" />
<p id="dd1"></p>
<p id="dd2"></p>-->
<script>
var div=document.getElementById("test"),/*dd1=document.getElementById("dd1"),dd2=document.getElementById("dd2"),*/x,y,_x=0,_y=0,test=null;

if(div.innerHTML==""&&/Firefox/i.test(navigator.userAgent)){div.innerHTML="&nbsp;";alert(/Firefox/i.test(navigator.userAgent))}
function moveDIV(){
div.onmousedown=function(event){
	/*event=event||window.event;
	var target=event.target||event.srcElement;
	if(target==div){*/
	test=document.getElementById("test");
	_x=x-div.offsetLeft;
	_y=y-div.offsetTop;//获得鼠标在元素中的位置
	//this.style.top=y-_y+"px";
	//this.style.left=x-_x+"px";
	div.style.backgroundColor="#3CF";
	//}
	}
document.onmousemove=function(event){
	event=event||window.event;
	x=event.clientX;y=event.clientY;
	//dd1.innerHTML=x+"!!"+_x+"/"+div.offsetLeft;dd2.innerHTML=y+"!!"+_y+"/"+div.offsetTop;
	if(test!=null){
	test.style.top=y-_y+"px";
	test.style.left=x-_x+"px";}//移动元素的位置
	event.preventDefault();
	}
document.onmouseup=function(event){
	/*event=event||window.event;
	var target=event.target||event.srcElement;
	if(target==div){*/
		test=null;_x=0;_y=0;div.style.backgroundColor="#f0c";}
	//}
 return false;
}
moveDIV()
/*window.addEventListener("mouseup",function(){test=null;_x=0;_y=0;div.style.backgroundColor="#f0c";},false)
window.addEventListener("mousedown",function(event){if(event.target==div){test=document.getElementById("test");_x=x-div.offsetLeft;_y=y-div.offsetTop;div.style.backgroundColor="#3CF";}},false)
window.addEventListener("mousemove",function(event){x=event.clientX;y=event.clientY;dd1.innerHTML=x+"!!"+_x+"/"+div.offsetLeft;dd2.innerHTML=y+"!!"+_y+"/"+div.offsetTop;if(test!=null){test.style.top=y-_y+"px";test.style.left=x-_x+"px";}},false)*/

</script>
</body>
</html>
